<?xml version="1.0" encoding="UTF-8"?>
<ChasteParameters
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../../src/io/ChasteParameters.xsd">
       
	<Simulation>
		<!-- 
			Problem definition 
		-->    
	    <SimulationDuration>10.0</SimulationDuration>
	    <Domain>Mono</Domain>
	    <IonicModel>FaberRudy2000Version3</IonicModel>
	    
		<!-- 
			Mesh definition 
		-->
		<Mesh>
			<Slab>    
		    	<SlabX>4.0</SlabX>
		    	<SlabY>0.1</SlabY>
		    	<SlabZ>2.0</SlabZ>
		    	<InterNodeSpace>0.1</InterNodeSpace>
	    	</Slab>
	  	</Mesh>
	
	    <!-- 
	    	Stimuli (as many <Stimulus> definitions as needed) 
	   	-->
   		<Stimuli>
		  	<Stimulus> <!-- #1 -->
				<Strength>-25500.0</Strength>
				<Duration>0.5</Duration>
				<Delay>0</Delay>
				<Location>
					<CornerA x="-5.0"  y="-0.125" z="-5.0"/>
					<CornerB x="-4.75" y="0.125"  z="5.0"/>
				</Location>
			</Stimulus>	
			<Stimulus> <!-- #2 -->
				<Strength>-25500.0</Strength>
				<Duration>0.5</Duration>
				<Delay>200.0</Delay>
				<Location>
					<CornerA x="-5.0" y="-0.125" z="-5.0"/>
					<CornerB x="0.0"  y="0.125"  z="0.0"/>
				</Location>
			</Stimulus>	
		</Stimuli>

	    <!-- 
	    	Ionic cell model heterogeneities (as many <CellHeterogeneity> definitions as needed) 
	   	-->
		<CellHeterogeneities>
		  	<CellHeterogeneity> <!-- #1 -->
				<ScaleFactorGks>0.462</ScaleFactorGks>
				<ScaleFactorIto>0.0</ScaleFactorIto>
				<Location>
					<CornerA x="-2.0" y="-0.1" z="-1.0"/>
					<CornerB x="-0.5" y="0.1" z="1.0"/>
				</Location>
			</CellHeterogeneity>	
		
		  	<CellHeterogeneity> <!-- #2 -->
				<ScaleFactorGks>1.154</ScaleFactorGks>
				<ScaleFactorIto>0.85</ScaleFactorIto>
				<Location>
					<CornerA x="-0.5" y="-0.1" z="-1.0"/>
					<CornerB x="0.5" y="0.1" z="1.0"/>
				</Location>
			</CellHeterogeneity>	
		
		  	<CellHeterogeneity> <!-- #3 -->
				<ScaleFactorGks>1.154</ScaleFactorGks>
				<ScaleFactorIto>1.0</ScaleFactorIto>
				<Location>
					<CornerA x="0.5" y="-0.1" z="-1.0"/>
					<CornerB x="2.0" y="0.1" z="1.0"/>
				</Location>
			</CellHeterogeneity>
		</CellHeterogeneities>		
		
		<ConductivityHeterogeneities>
			<ConductivityHeterogeneity> <!-- #1 -->
			    <IntracellularConductivities longi="2.75" trans="2.75" normal="2.75" />
	    		<ExtracellularConductivities longi="8.0"  trans="8.0"  normal="8.0" />				
				<Location>
					<CornerA x="1.9" y="-0.1" z="-1.0"/>
					<CornerB x="2.0" y="0.1" z="1.0"/>
				</Location>				
			</ConductivityHeterogeneity>		

			<ConductivityHeterogeneity> <!-- #2 -->
			    <IntracellularConductivities longi="0.75" trans="0.75" normal="0.75" />
				<Location>
					<CornerA x="-0.1" y="-0.1" z="-1.0"/>
					<CornerB x="0.1"  y="0.1"  z="1.0"/>
				</Location>				
			</ConductivityHeterogeneity>		

			<ConductivityHeterogeneity> <!-- #3 -->
				<ExtracellularConductivities longi="8.0"  trans="8.0"  normal="8.0" />				
				<Location>
					<CornerA x="-2.0" y="-0.1" z="-1.0"/>
					<CornerB x="-1.9"  y="0.1"  z="1.0"/>
				</Location>				
			</ConductivityHeterogeneity>		
		</ConductivityHeterogeneities>		

		<!-- 
			Output 
		-->
		<OutputDirectory>ChasteResults</OutputDirectory>
	</Simulation>
	
	<Physiological>
	    <!--
	        Conductivities
	    -->
	    <IntracellularConductivities longi="1.75" trans="1.75" normal="1.75" />
	    <ExtracellularConductivities longi="7.0"  trans="7.0"  normal="7.0" />
	    <SurfaceAreaToVolumeRatio> 1400 </SurfaceAreaToVolumeRatio>
	    <Capacitance> 1.0 </Capacitance>
	</Physiological>

	<Numerical>
		<TimeSteps ode="0.025" pde="0.05" printing="1.0"/>
		<KSPTolerances>
			<KSPRelative>1e-6</KSPRelative>
		</KSPTolerances>
		<KSPSolver>gmres</KSPSolver>
		<KSPPreconditioner>ilu</KSPPreconditioner>
	</Numerical>

</ChasteParameters>
