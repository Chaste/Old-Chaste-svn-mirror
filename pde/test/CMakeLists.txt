project(testpde)

if(ENABLE_CHASTE_TESTING)
#copy test data
file(COPY data DESTINATION "${CHASTE_BUILD_ROOT_DIR}/pde/test")

#add_definitions(-D_USE_MATH_DEFINES)

include_directories("${CHASTE_PDE_INCLUDE_DIRS}" 
"${CMAKE_CURRENT_SOURCE_DIR}" "${CMAKE_CURRENT_SOURCE_DIR}/pdes" "${CXXTEST_INCLUDES}" 
"${CHASTE_GLOBAL_INCLUDE_DIRS}" "${CHASTE_LINALG_INCLUDE_DIRS}" "${CHASTE_IO_INCLUDE_DIRS}")

#Auto-generate test suites
set(COMPONENT_LIBRARIES pde ode mesh linalg io global)
file(GLOB_RECURSE TEST_SUITES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} Test*.hpp)

set(TEST_MPIEXEC_ENABLED TRUE)
set(HAS_OWN_LINKER_FLAGS TRUE)
set(LINKER_FLAGS "/NODEFAULTLIB:LIBCMT /NODEFAULTLIB:MSVCRT /NODEFAULTLIB:MSVCRTD")
chaste_generate_test_suites()

endif(ENABLE_CHASTE_TESTING)